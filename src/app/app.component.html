<div class="wrapper" [ngClass]="{'darkMode': gameStateService.isDarkMode}">
  <div class="mainContainer">
    <div class="top-line">
      <span class="gameTitle">
        Immortality Idle - {{characterService.characterState.god ? "The Divine Cultivator" : hellService.inHell ? "Escape from The Eighteen Hells" : characterService.characterState.immortal ? "You are Immortal!" : "Can you become an immortal?"}}
        <span class="versionNumber" (click)="changelogClicked()">{{gameStateService.isExperimental ? "Experimental" : "v" + applicationVersion}}</span>
      </span>
      <mat-icon matTooltip="Confused? Click here." class="iconButton" (click)="tutorialClicked()" aria-label="Tutorial" aria-hidden="false">
        help
      </mat-icon>
      <mat-icon matTooltip="Statistics!" class="iconButton" (click)="statisticsClicked()">
        format_list_numbered_rtl
      </mat-icon>
      <span>
        <mat-icon matTooltip="A store that sells special manuals for aspiring immortals." class="iconButton" aria-label="Store" aria-hidden="false"
          [ngClass]="{highlighted: storeService.isManualAvailable()}"
          (click)="storeClicked()">
          local_library
        </mat-icon>
        <mat-icon matTooltip="Options. Lots of them." class="iconButton" aria-label="Options" aria-hidden="false"
          (click)="storeOptionsClicked()">
          settings
        </mat-icon>
      </span>
      <mat-icon matTooltip="Achievements!" class="iconButton" aria-label="Achievements" aria-hidden="false"
        (click)="achievementsClicked()">
        military_tech
      </mat-icon>
      <mat-icon matTooltip="Impossible Tasks" class="iconButton" *ngIf="impossibleTaskService.impossibleTasksUnlocked" aria-label="Impossible Tasks" aria-hidden="false"
        (click)="impossibleTasksClicked()">
        priority_high
      </mat-icon>
      <span *ngIf="characterService.characterState.ascensionUnlocked">
        <mat-icon matTooltip="Ascension Techniques." class="iconButton" aria-label="Ascension" aria-hidden="false"
          (click)="ascensionStoreClicked()">
          keyboard_double_arrow_up
        </mat-icon>
      </span>
      <span class="discordLink">
        <a href="https://discord.gg/Na7Qmwy3XK" target="_blank" rel="noopener noreferrer" matTooltip="Have questions? Try the Immortality Idle Discord.">Discord</a>
      </span>
    </div>
    <div class="bodyContainer" #bodyContainer (mousemove)="onBodyDrag($event)">
      <app-time-panel cdkDrag  appResizable class="timePanel panel"
        [ngStyle]="{'z-index': gameStateService.panelZIndex[panelIndex.Time]}"
        (cdkDragEnded)="dragEnd($event, panelIndex.Time)"
        (cdkDragStarted)="dragStart($event, panelIndex.Time)"
        [cdkDragFreeDragPosition]="gameStateService.panelPositions[panelIndex.Time]"
        cdkDragBoundary=".bodyContainer">
      </app-time-panel>
      <app-attributes-panel cdkDrag appResizable class="attributesPanel panel" 
        [ngStyle]="{'z-index': gameStateService.panelZIndex[panelIndex.Attributes]}"
        (cdkDragEnded)="dragEnd($event, panelIndex.Attributes)"
        (cdkDragStarted)="dragStart($event, panelIndex.Attributes)"
        [cdkDragFreeDragPosition]="gameStateService.panelPositions[panelIndex.Attributes]"
        cdkDragBoundary=".bodyContainer">
      </app-attributes-panel>
      <app-followers-panel *ngIf="followersService.followersUnlocked" cdkDrag appResizable class="followersPanel panel" 
        [ngStyle]="{'z-index': gameStateService.panelZIndex[panelIndex.Followers]}"
        (cdkDragEnded)="dragEnd($event, panelIndex.Followers)"
        (cdkDragStarted)="dragStart($event, panelIndex.Followers)"
        [cdkDragFreeDragPosition]="gameStateService.panelPositions[panelIndex.Followers]"
        cdkDragBoundary=".bodyContainer">
      </app-followers-panel>
      <app-health-panel cdkDrag appResizable class="healthPanel panel"
        [ngStyle]="{'z-index': gameStateService.panelZIndex[panelIndex.Health]}"
        (cdkDragEnded)="dragEnd($event, panelIndex.Health)"
        (cdkDragStarted)="dragStart($event, panelIndex.Health)"
        [cdkDragFreeDragPosition]="gameStateService.panelPositions[panelIndex.Health]"
        cdkDragBoundary=".bodyContainer">
      </app-health-panel>
      <app-activity-panel cdkDrag appResizable class="activityPanel panel" 
        [ngStyle]="{'z-index': gameStateService.panelZIndex[panelIndex.Activity]}"
        (cdkDragEnded)="dragEnd($event, panelIndex.Activity)"
        (cdkDragStarted)="dragStart($event, panelIndex.Activity)"
        [cdkDragFreeDragPosition]="gameStateService.panelPositions[panelIndex.Activity]"
        cdkDragBoundary=".bodyContainer">
      </app-activity-panel>
      <app-battle-panel cdkDrag appResizable class="battlePanel panel" 
        [ngStyle]="{'z-index': gameStateService.panelZIndex[panelIndex.Battle]}"
        (cdkDragEnded)="dragEnd($event, panelIndex.Battle)"
        (cdkDragStarted)="dragStart($event, panelIndex.Battle)"
        [cdkDragFreeDragPosition]="gameStateService.panelPositions[panelIndex.Battle]"
        cdkDragBoundary=".bodyContainer">
      </app-battle-panel>
      <app-equipment-panel cdkDrag appResizable class="equipmentPanel panel" 
        [ngStyle]="{'z-index': gameStateService.panelZIndex[panelIndex.Equipment]}"
        (cdkDragEnded)="dragEnd($event, panelIndex.Equipment)"
        (cdkDragStarted)="dragStart($event, panelIndex.Equipment)"
        [cdkDragFreeDragPosition]="gameStateService.panelPositions[panelIndex.Equipment]"
        cdkDragBoundary=".bodyContainer">
      </app-equipment-panel>
      <app-home-panel cdkDrag appResizable class="homePanel panel" 
        [ngStyle]="{'z-index': gameStateService.panelZIndex[panelIndex.Home]}"
        (cdkDragEnded)="dragEnd($event, panelIndex.Home)"
        (cdkDragStarted)="dragStart($event, panelIndex.Home)"
        [cdkDragFreeDragPosition]="gameStateService.panelPositions[panelIndex.Home]"
        cdkDragBoundary=".bodyContainer">
      </app-home-panel>
      <app-inventory-panel cdkDrag appResizable class="inventoryPanel panel" 
        [ngStyle]="{'z-index': gameStateService.panelZIndex[panelIndex.Inventory]}"
        (cdkDragEnded)="dragEnd($event, panelIndex.Inventory)"
        (cdkDragStarted)="dragStart($event, panelIndex.Inventory)"
        [cdkDragFreeDragPosition]="gameStateService.panelPositions[panelIndex.Inventory]"
        cdkDragBoundary=".bodyContainer">
      </app-inventory-panel>
      <app-log-panel cdkDrag class="logPanel panel" 
        [ngStyle]="{'z-index': gameStateService.panelZIndex[panelIndex.Log]}"
        (cdkDragEnded)="dragEnd($event, panelIndex.Log)"
        (cdkDragStarted)="dragStart($event, panelIndex.Log)"
        [cdkDragFreeDragPosition]="gameStateService.panelPositions[panelIndex.Log]"
        cdkDragBoundary=".bodyContainer">
      </app-log-panel>
    </div>
  </div>
</div>
